{% extends 'base.html.twig' %}

{% block title %}{{filmsShow.title}}{% endblock %}

{% block body %}
    <div class="card bg-light shadow movieCard">
        <div class="card-body row mt-4">
            <div class="col-md-4 col-xs-12 text-center">
                {% if filmsShow.poster_path is not empty %}
                    <img class="shadow" src="{{ imageUrl ~ 'w342' ~ filmsShow.poster_path }}" alt="{{ filmsShow.title }} Poster" class=" imgFilm img-fluid rounded mb-3">
                {% else %}
                    <img class="shadow" src="{{ asset('images/no_image_available_w342_h513.png') }}" class="img-fluid rounded mb-3" alt="No image available">
                {% endif %}
            </div>

            <div class="col-md-8 col-xs-12">
                <h1 class="text-start">{{ filmsShow.title }}</h1>

                <div class="d-flex">
                    {# <p class="mb-0"> #}
                        {% set directors = [] %}
                        {% for person in director %}
                            {% if person.job == 'Director' %}
                                {% set directors = directors|merge([person.name]) %}
                            {% endif %}
                        {% endfor %}

                        {% if directors|length > 1 %}
                            <p class="p-bold">Réalisation :&nbsp;</p> {{ directors|join(', ') }}<br>
                        {% else %}
                            <p class="p-bold">Réalisation :&nbsp;</p>{{ directors[0] }}<br>
                        {% endif %}
                    {# </p> #}
                </div>
                    
                <div class="d-flex">
                    <p class="p-bold">Durée :&nbsp;</p> {{ filmsShow.runtime }} mn
                    </p>
                </div>
                <div class="d-flex">
                    <p class="p-bold">Année de sortie :&nbsp;</p> {{ filmsShow.release_date|slice(0,4) }}
                </div>
                    <p class="mb-4 overview">{{ filmsShow.overview }}</p>

                <p class="p-bold mb-0">Têtes d'affiche :</p>
                {# <div class="d-flex wrap"> #}
                    {% for actor in cast|slice(0, 5) %}
                        {# <div class="text-center me-1 mb-0"> #}
                            {{ actor.name }}{% if not loop.last %},&nbsp;{% endif %}
                        {# </div> #}
                    {% endfor %}
                {# </div> #}
                
                <div class="mt-3">
                    <p class="p-bold">Acheter ce film :</p>
                    <div class=" logoFormatsContainer d-flex mb-3">
                        <img class="logoFormats me-3 shadow rounded" src="{{asset('images/vhs_logo_w100.png')}}" alt="Logo VHS">
                        <img class="logoFormats me-3 shadow rounded" src="{{asset('images/dvd_logo_w100.png')}}" alt="Logo DVD">
                        <img class="logoFormats me-3 shadow rounded" src="{{asset('images/bluray_logo_w100.png')}}" alt="Logo Blu-Ray">
                    </div>
                </div>

                <div>
                    {% if buy is defined and buy is not empty %}
                        <ul class="providers d-flex flex-wrap me-1 ps-0">
                            {% for provider in buy %}
                                {% if provider.logo_path is defined %}
                                <li class="provider ms-1"><img src="{{ imageUrl ~ 'w45' ~ provider.logo_path }}" class="img-fluid rounded mb-1" alt="{{ provider.provider_name }} logo"></li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div>
                    {% if rent is defined and rent is not empty %}
                        <p class="p-bold">Louer ce film :</p>
                        <ul class="providers d-flex flex-wrap me-1 ps-0">
                            {% for provider in rent %}
                                {% if provider.logo_path is defined %}
                                <li class="provider ms-1"><img src="{{ imageUrl ~ 'w45' ~ provider.logo_path }}" class="img-fluid rounded mb-1" alt="{{ provider.provider_name }} logo"></li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div>
                    {% if flatrate is defined and flatrate is not empty %}
                        <p class="p-bold">Streaming avec abonnement :</p>
                        <ul class="providers d-flex flex-wrap me-1 ps-0">
                            {% for provider in flatrate %}
                                {% if provider.logo_path is defined %}
                                <li class="provider ms-1"><img src="{{ imageUrl ~ 'w45' ~ provider.logo_path }}" class="img-fluid rounded mb-1" alt="{{ provider.provider_name }} logo"></li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    {% else %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
